---
phase: 05-packaging-distribution
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - justfile
  - package.json
autonomous: true

must_haves:
  truths:
    - "Developer can run `just` to see available commands"
    - "Developer can run `just build` to compile TypeScript"
    - "Developer can run `just test` to run tests (once tests exist)"
    - "Developer can run `just lint` to check code"
    - "Developer can run `just clean` to remove artifacts"
    - "Developer can run `just release-build` for full release prep"
  artifacts:
    - path: "justfile"
      provides: "Task runner recipes"
      contains: "build:"
    - path: "package.json"
      provides: "lint script for tsc --noEmit"
      contains: "lint"
  key_links:
    - from: "justfile"
      to: "npm run build"
      via: "just build recipe"
      pattern: "npm run build"
---

<objective>
Create justfile with build, test, lint, clean, and release automation recipes.

Purpose: Provide discoverable, standardized commands for common development tasks. just is simpler than Make, cross-platform, and self-documenting with `just --list`.

Output: Working justfile with all common development recipes.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/05-packaging-distribution/05-RESEARCH.md
@package.json
@tsup.config.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add lint script to package.json</name>
  <files>package.json</files>
  <action>
Add "lint" script to package.json scripts section:
```json
"lint": "tsc --noEmit"
```

This performs type checking without emitting files - the standard lint check for TypeScript projects without additional ESLint setup.
  </action>
  <verify>Run `npm run lint` - should succeed with no type errors</verify>
  <done>package.json has lint script that type-checks the codebase</done>
</task>

<task type="auto">
  <name>Task 2: Create justfile with development recipes</name>
  <files>justfile</files>
  <action>
Create justfile at project root with these recipes (follow https://just.systems/man/en/ conventions):

```just
# Default: list available recipes
default:
  @just --list

# Build TypeScript to dist/
build:
  npm run build

# Run tests (placeholder until tests exist)
test:
  @echo "No tests configured yet"

# Lint and type check
lint:
  npm run lint

# Generate man page from markdown (used by 05-02)
man:
  mkdir -p man
  npx marked-man docs/gitsneak.1.md --section 1 --name gitsneak --version $(node -p "require('./package.json').version") > man/gitsneak.1

# Clean all generated files
clean:
  rm -rf dist man

# Full build for release (clean + build + man)
release-build: clean build man
  @echo "Release build complete"

# Verify npm package contents
verify:
  npm pack --dry-run

# Create git tag and push (CI handles npm publish)
release version:
  npm version {{version}} -m "release: v%s"
  git push --follow-tags
```

Key design choices:
- `default` shows help via `just --list` for discoverability
- `test` is a placeholder - no test framework currently in project
- `man` recipe will be used once 05-02 adds the markdown source
- `release-build` composes clean + build + man for full prep
- `release` creates version tag for CI to pick up
  </action>
  <verify>Run `just` - should display list of available recipes. Run `just build` - should compile successfully.</verify>
  <done>justfile exists with all recipes, `just` shows help, `just build` compiles project</done>
</task>

<task type="auto">
  <name>Task 3: Verify just installation and recipes work</name>
  <files></files>
  <action>
Verify the just command runner is available. If not installed, provide installation note.

Test each recipe that can run without dependencies:
1. `just` - should list recipes
2. `just build` - should compile
3. `just lint` - should type-check
4. `just clean` - should remove dist/
5. `just verify` - should show npm pack preview

Note: `just man` will fail until 05-02 creates docs/gitsneak.1.md - this is expected.
  </action>
  <verify>All testable recipes execute without error. Build artifacts created in dist/.</verify>
  <done>Justfile fully functional for current project state</done>
</task>

</tasks>

<verification>
1. `just` displays formatted list of available commands
2. `just build` produces dist/index.js with shebang
3. `just lint` exits 0 with no type errors
4. `just clean && ls dist` shows dist removed
5. `just verify` shows npm package contents preview
</verification>

<success_criteria>
- DIST-04 requirement satisfied: Justfile for build, test, lint workflows
- Developer can discover commands with `just`
- All recipes except `man` execute successfully
</success_criteria>

<output>
After completion, create `.planning/phases/05-packaging-distribution/05-01-SUMMARY.md`
</output>
